# Repository Guidelines

## Project Structure & Module Organization
- `src/`: SvelteKit application source.
- `src/routes/`: Route entry points (e.g., `+page.svelte`, `debug/+page.svelte`).
- `src/lib/game/`: Core game logic (board, input, RNG, rendering helpers).
- `tests/`: Vitest unit tests (currently `tetris.test.ts`).
- `build/`: Static build output (generated by `npm run build`).
- `Dockerfile`, `docker-compose.yml`, `nginx.conf`: Containerized dev and production setup.

## Build, Test, and Development Commands
- `npm install`: Install dependencies.
- `npm run dev`: Local dev server (Vite, port `5173`).
- `npm run build`: Production build (static output in `build/`).
- `npm run preview`: Preview the production build (port `4173`).
- `npm run typecheck`: Run `svelte-check` against `tsconfig.json`.
- `npm test`: Run Vitest.
- `npm run lint`: Run ESLint across the repo.
- `npm run format`: Check formatting with Prettier.
- `npm run format:fix`: Auto-format with Prettier.
- `docker compose up dev`: Start the Docker dev environment with live reload.
- `docker compose up prod`: Build and run the production nginx container (port `8080`).

## Coding Style & Naming Conventions
- Use 2-space indentation (matches existing TS/Svelte files).
- Prefer TypeScript types and `type` imports for shared models.
- Route components follow SvelteKit naming (`+page.svelte`).
- Game modules in `src/lib/game/` use descriptive, lowercase filenames (e.g., `tetris.ts`).

## Testing Guidelines
- Framework: Vitest.
- Place unit tests in `tests/` with `*.test.ts` naming.
- Keep tests deterministic (mock RNG/time where needed).
- Run tests with `npm test` before opening a PR.

## Commit & Pull Request Guidelines
- No git history is available in this checkout, so follow your team’s standard.
- If unsure, use concise, imperative subject lines (e.g., “Add ghost piece rendering”).
- PRs should include: a brief summary, test results (commands run), and screenshots for UI changes.
- Link related issues or tasks when applicable.

## Configuration & Deployment Notes
- Static deployment uses `@sveltejs/adapter-static` with `build/` as both pages and assets.
- Docker dev sets `CHOKIDAR_USEPOLLING=true` to improve file watching in containers.

# ExecPlans
When writing complex features or significant refactors, use an ExecPlan (as described in .agent/PLANS.md) from design to implementation.

